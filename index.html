<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>index</title>
</head>
<link rel="stylesheet" href="css/reset.css">
<link rel="stylesheet" href="css/main.css">

<body>
<div class="container">
<div id="header">
<div id="left-top">
    <ul>
      <li><i class="iconfont">&#xe611;</i><a href="#">给我们意见</a></li>
      <li><i class="iconfont">&#xe91a;</i><a href="#">关于我们</a></li>
      <li><i class="iconfont">&#xe638;</i><a href="javascript:aLogin()">会员登录</a></li>
  </ul>

</div>
  <div id="navi">
  <ul>
	    <li><a href="#">首页</a></li>
      <li><a href="breads.html">全部面包</a></li>
      <li><a href="course.html">面包课堂</a></li>
      <li><a href="activity.html">会员社区</a></li>
  </ul>
  </div>
  <div class="form-box">
     <form action="#" method="get">
	     <input type = "text" placeholder="搜索" class="search"/>
        <input type = "submit"class="searchBtn" value=""/><!--<button class="searchBtn"><i class="iconfont">&#xe608;</i></button>-->
    </form>
  </div>
</div>
<!--修改成模板-->
<div class="slider">
	<div class="main" id="template_main">
    	<div class="main-i {{css}}" id="main_{{index}}">
            <div class="caption">
                <h2>{{h2}}</h2>
                <h3>{{h3}}</h3>
         	 </div>
        	<img src="image/{{index}}.jpg">
        </div>
    </div>
    <!-- <div class="left_ctrl">
      <img src="image/left.png" alt="">
    </div>
    <div class="right_ctrl">
      <img src="image/right.png" alt="">
    </div> -->
    <div class="ctrl" id="template_ctrl">
    <!--通过<a>标签,连接到脚本，进行幻灯片跳转，通过index来制定相应的幻灯片，这里的index在后面被替换成相应的数字-->
    	<a class="ctrl-i" id="ctrl_{{index}}" href="javascript:switchSlider({{index}});"><img src="image/{{index}}.jpg"></a>

    </div>

</div>


  <div class="tags">
    <h3>标签</h3>
    <a href="#" style="font-size:18pt">12月活动</a href="#">
    <a href="#" style="font-size:14pt">百慕大三角面包</a href="#">
    <a href="#" style="font-size:18pt">我与烘培面包的故事</a href="#">
    <a href="#" style="font-size:14pt">开心果欧修</a href="#">
    <a href="#" style="font-size:14pt">11月活动</a href="#">
    <a href="#" style="font-size:18pt">我的自创面包</a href="#">
    <a href="#" style="font-size:12pt">奶油包</a href="#">
    <a href="#" style="font-size:14pt">大理石吐司</a href="#">
    <a href="#" style="font-size:12pt">雪山面包</a href="#">

  </div>

  <div id="photoGallery">
      <div class="photoMenu">
        <div class="photo">
            <img src="image/breads/pizzaBread.jpg">
            <a href="breads.html"><div class="photoMask">
              <h2>人气面包</h2>
            </div>
            </a>
      </div>

       <div class="photo">
            <img src="image/course/toast.jpg" >
            <a href="course.html"><div class="photoMask">
              <h2>热门课堂</h2>
            </div>
            </a>
      </div>
         <div class="photo">
            <img src="image/activity/December.jpg">
            <a href="activity.html"><div class="photoMask">
              <h2>最新活动</h2>
            </div>
            </a>
        </div>
    </div>
  </div>

</div>

<!--                      footer                             -->
<div id="footer">
  <img src="image/logos.png">
  <div class="footerDl clearfloat">
    <dl class="footerText">
      <dt>给我们的意见</dt>
      <dd><a href="#">发送邮件</a></dd>
      <dd><a href="#">联系我们</a></dd>
    </dl>
   <dl class="footerText">
     <dt>关于我们</dt>
       <dd><a href="https://www.freecodecamp.cn/cyanxxx">关注作者</a></dd>
       <dd><a href="http://www.imooc.com/learn/412">查看参考</a></dd>
   </dl>
 <dl class="footerText">
   <dt>客户服务</dt>
     <dd><a href="#">帮助中心</a></dd>
     <dd><a href="#">联系客服</a></dd>
 </dl>
 <dl class="footerText">
   <dt>友情链接</dt>
     <dd><a href="http://www.haodou.com/s?wd=%E5%90%90%E5%8F%B8&tp=recipe">好豆网</a></dd>
     <dd><a href="https://www.zhihu.com/topic/19629004/top-answers">知乎烘培</a></dd>
 </dl>
  </div>
</div>


<script type="text/javascript">
var data = [
	  {img:1,h2:'经典美味',h3:'吐司'},
      {img:2,h2:'酥香可口',h3:'羊角包'},
      {img:3,h2:'香浓美味',h3:'芝麻包'},
      {img:4,h2:'嚼劲十足',h3:'法棍'},

	  ];

/*  通用函数来获取元素   */
var g= function(id){
	if(id.substr(0,1) == '.'){
    //从classname的第一个字符串开始获取字符串  .main_i ==> main_i
    		return document.getElementsByClassName(id.substr(1));
		}
	return document.getElementById(id);
	}


/*	添加幻灯片,并把多余的空白符去掉	*/
function	addSliders() {

  //获取模板
	var tpl_main = g('template_main').innerHTML.replace(/^\s+/,'').replace(/\s+$/,'');
	var tpl_ctrl = g('template_ctrl').innerHTML.replace(/^\s+/,'').replace(/\s+$/,'');


/*  定义最终输出的变量   */
	var out_main=[];
	var out_ctrl=[];

/*  遍历所有数据，修改模板   */
	 for( i in data){
        var _html_main=tpl_main.replace(/{{index}}/g,data[i].img)
                              .replace(/{{h2}}/g,data[i].h2)
                              .replace(/{{h3}}/g,data[i].h3)

        var _html_ctrl=tpl_ctrl.replace(/{{index}}/g,data[i].img);
        if(i==0){
          var first_main = _html_main;
          var first_ctrl = _html_ctrl;
        }
        /*    把所有数据返回   */
        out_main.push(_html_main);
        out_ctrl.push(_html_ctrl);

      }
      /*  将最后一张再插到第一张  */
      out_main.unshift(_html_main);
      out_main.push(first_main);
      /*    把HTML 回写到对应的DOM里面   */
      g('template_main').innerHTML=out_main.join('');
      g('template_ctrl').innerHTML=out_ctrl.join('');

    }



/*----------完成幻灯片的添加并套入了对应的模板输出-------------------  */

//    切换幻灯片
  function switchSlider(n){
      //  获得要展现的幻灯片&控制按钮 DOM
      var main=g('main_'+n);
      var ctrl=g('ctrl_'+n);
      //  获得所有的幻灯片以及控制按钮
      var clear_main=g('.main-i');
      var clear_ctrl=g('.ctrl-i');
      //  清除他们的active样式，g('.main_i')返回的不是真正意义的数组对象，不能用for in
      for(i=0;i<clear_ctrl.length;i++){
        clear_main[i].className=clear_main[i].className.replace('main-i_active','');
        clear_ctrl[i].className=clear_ctrl[i].className.replace('ctrl-i_active','');
      }
      //  为当前控制按钮和幻灯片附加样式
      main.className+=' main-i_active';
      ctrl.className+=' ctrl-i_active';

    }


    //在页面加载完后调用函数
    window.onload=function(){
      addSliders();
    /*默认展现第一个*/
      switchSlider(1);
      showPhoto();
    }

function showPhoto(){
  var pMask= document.getElementsByClassName("photoMask");
   var photo= document.getElementsByClassName("photo");
  for(var i = 0; i<pMask.length; i++){
    pMask[i].onmouseover = function(){
      this.style.opacity=0;
    }
    pMask[i].onmouseout = function(){
      this.style.opacity=0.75;
    }
  }
}



function aLogin(){
  //插入遮罩层
    var sHeight = document.body.scrollHeight;
    var sWidth = document.body.scrollWidth;
    var mask = document.createElement("div");
    mask.id = "mask";
    mask.style.height = sHeight + "px";
    mask.style.width = sWidth + "px";
  document.body.appendChild(mask);

  //插入login
  var login = document.createElement("div");
  login.id ="login";
  document.body.appendChild(login);
  login.innerHTML="<form action='#' method='post'><div id='loginTop'><h3>登录</h3><div id='close'></div></div><div class='formGroups '><input type='text' placeholder='用户名'></div><div class='formGroups'><input type='password' placeholder='密码'> </div><div id='loginTip'><input type='checkbox'><span>两周内自动登录</span></div><div class='loginBtn'><input type='submit' value='登录' class='submit'></div><div class='loginBtn'><input type='submit' value='注册' class='submit'></div></form>";


  var cHeight = document.documentElement.clientHeight;
  var oHeight = login.offsetHeight;
  var oWidth = login.offsetWidth;
  login.style.top = (cHeight-oHeight)/2;
  login.style.left = (sWidth-oWidth)/2;

  //关闭
  var close = document.getElementById("close");
  close.onclick = function(){
    document.body.removeChild(login);
    document.body.removeChild(mask);
  }
}

</script>
</body>
</html>
